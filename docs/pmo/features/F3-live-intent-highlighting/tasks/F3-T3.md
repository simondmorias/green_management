# F3-T3 - Live Intent Highlighting - Entity Recognition Service

## Document Control
**Feature Name & Link:** [Live Intent Highlighting for Conversational Interface](../feature.md)
**Plan Name & Link:** [Implementation Plan](../plan.md)
**Date Created:** September 1, 2025  
**Status:** Not Started

---

## Overview
Implement the core entity recognition service using Aho-Corasick algorithm for exact matching, with FastAPI endpoint for real-time recognition.

---

## Task Requirements

### Task1: Aho-Corasick Entity Matcher Implementation
**Status:** Not Started

**Description:**
Build the entity recognition service that uses Aho-Corasick automaton for efficient multi-pattern matching. The service should process text in under 100ms, identify entity boundaries correctly, and return tagged text with entity metadata.

**Technical Details:**
- Files to create/modify:
  - `/gain/apps/api/app/services/entity_recognizer.py` - Core recognition service
  - `/gain/apps/api/app/services/aho_corasick_matcher.py` - Aho-Corasick implementation
  - `/gain/apps/api/app/routes/chat.py` - Add recognition endpoint
  - `/gain/apps/api/app/schemas/entity_recognition.py` - Request/response schemas
  - `/gain/apps/api/tests/test_entity_recognition.py` - Unit tests

- Key implementation points:
  - Implement Aho-Corasick trie construction from gazetteer
  - Add word boundary detection to avoid partial matches
  - Handle overlapping entities with priority rules (Manufacturer > Product > Metric > Time)
  - Case-insensitive matching with original case preservation
  - Generate XML-style tags for matched entities
  - Include entity metadata (type, ID, confidence, position)
  - Optimize for sub-100ms processing
  - Add stopword filtering for performance

**Acceptance Criteria:**
- [ ] Entity recognition completes in < 100ms for 95% of queries
- [ ] Exact match accuracy > 99%
- [ ] Word boundaries correctly detected
- [ ] Overlapping entities handled by priority rules
- [ ] Case-insensitive matching works correctly
- [ ] Response includes tagged text and entity metadata
- [ ] Handles queries up to 500 characters
- [ ] Unit tests achieve > 90% coverage
- [ ] API endpoint returns proper error codes

## Developer Completion Details

*To be completed by the developer at the end of the task implementation*

### Metadata

- Repo Name: Gain
- Branch Name: [Branch Name]

### Summary of Changes

**Overview**
*Write 500 words to summarise what was done and any issues discovered*

**Testing Notes:**
*Specific test scenarios to verify*

**Definition of Done:**
- [ ] Code implemented and peer reviewed
- [ ] Tests written and passing
- [ ] Documentation updated
- [ ] No linting errors
- [ ] Ready for PR and Approval